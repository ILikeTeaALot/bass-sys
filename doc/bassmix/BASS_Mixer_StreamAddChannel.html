<!doctype html><html><head><link rel="stylesheet" type="text/css" href="bass.css"></head><body>
<h1>BASS_Mixer_StreamAddChannel</h1>
<p>Plugs a channel into a mixer.
<p><pre class="def">BOOL BASS_Mixer_StreamAddChannel(
    HSTREAM <I>handle</I>,
    DWORD <I>channel</I>,
    DWORD <I>flags</I>
);</pre>
<p><h2>Parameters</h2>
<table>
<tr><td>handle<td>The mixer handle.
<tr><td>channel<td>The handle of the channel to plug into the mixer... a HMUSIC, HSTREAM or HRECORD.
<tr><td>flags<td>Any combination of these flags.
<table>
<tr><td>BASS_MIXER_CHAN_BUFFER<td>Buffer the sample data, for use by <a href="BASS_Mixer_ChannelGetData.html">BASS_Mixer_ChannelGetData</a> and <a href="BASS_Mixer_ChannelGetLevel.html">BASS_Mixer_ChannelGetLevel</a> and <a href="BASS_Mixer_ChannelGetLevelEx.html">BASS_Mixer_ChannelGetLevelEx</a>. This increases memory requirements, so should not be enabled needlessly. The size of the buffer can be controlled via the <a href="BASS_CONFIG_MIXER_BUFFER.html">BASS_CONFIG_MIXER_BUFFER</a> config option.
<tr><td>BASS_MIXER_CHAN_DOWNMIX<td>If the source uses channels/speakers that the mixer output does not have, then a <a href=matrix.html>matrix</a> is created and initialized with a suitable downmixing matrix (for up to 8 channels). Note the source sample data is assumed to follow the standard channel ordering, as described in the <a href="mk:@MSITStore:bass.chm::/STREAMPROC.html">STREAMPROC</a> documentation.
<tr><td>BASS_MIXER_CHAN_LIMIT<td>Limit the mixer processing to the amount of data available from this source, while the source is active (not ended). If the source stalls, then the mixer will too, rather than continuing to mix other sources, as it would normally do. This flag can only be applied to one source per mixer, so it will automatically be removed from any other source of the same mixer.
<tr><td>BASS_MIXER_CHAN_MATRIX<td>Creates a <a href=matrix.html>matrix</a>, allowing the source's channels to be sent to any of the mixer output channels, at any levels. The matrix can be retrieved and modified via the <a href="BASS_Mixer_ChannelGetMatrix.html">BASS_Mixer_ChannelGetMatrix</a> and <a href="BASS_Mixer_ChannelSetMatrix.html">BASS_Mixer_ChannelSetMatrix</a> functions. The matrix will initially contain a mapping of the source's channels to the mixer's corresponding channels, or a one-to-one mapping (1st out = 1st in, 2nd out = 2nd in, etc) if the BASS_MIXER_NOSPEAKER flag is set on the mixer.
<tr><td>BASS_MIXER_CHAN_NORAMPIN<td>Do not ramp-in the start, including after seeking (<a href="BASS_Mixer_ChannelSetPosition.html">BASS_Mixer_ChannelSetPosition</a>). This is useful for gapless playback, where a source channel is intended to seamlessly follow another. Even without this flag, ramping-in is skipped when the sample data begins at a low level (below -42dB). This does not affect volume and pan changes, which are always ramped.
<tr><td>BASS_MIXER_CHAN_PAUSE<td>Pause processing of the source. Use <a href="BASS_Mixer_ChannelFlags.html">BASS_Mixer_ChannelFlags</a> to resume processing.
<tr><td>BASS_STREAM_AUTOFREE<td>Automatically free the source channel when it ends. This allows you to add a channel to a mixer and forget about it, as it will automatically be freed when it has reached the end, or when the source is removed from the mixer or when the mixer is freed. When the mixer reaches the end of it, the source will be freed asynchronously (in another thread) to avoid delaying the mixer's other processing.
<tr><td>BASS_SPEAKER_<i>xxx</i><td><a href=mk:@MSITStore:bass.chm::/speaker.html>Speaker assignment flags</a>. If matrix mixing is enabled then the matrix will be initialized to place the source on the requested speaker(s), with downmixing also applied if the BASS_MIXER_CHAN_DOWNMIX flag is specified.
</table>
</table>
<p><h2>Return value</h2>
If successful, then TRUE is returned, else FALSE is returned. Use <a href="mk:@MSITStore:bass.chm::/BASS_ErrorGetCode.html">BASS_ErrorGetCode</a> to get the error code.
<p><h2>Error codes</h2>
<table>
<tr><td>BASS_ERROR_HANDLE<td>At least one of <I>handle</I> and <i>channel</i> is not valid.
<tr><td>BASS_ERROR_DECODE<td><i>channel</i> is not a decoding channel.
<tr><td>BASS_ERROR_ALREADY<td><i>channel</i> is already plugged into a mixer. It must be unplugged first.
<tr><td>BASS_ERROR_SPEAKER<td>The mixer does not support the requested speaker(s), or you are attempting to assign a stereo stream to a mono speaker.
</table>
<p><h2>Remarks</h2>
Internally, a mixer will use the <a href="mk:@MSITStore:bass.chm::/BASS_ChannelGetData.html">BASS_ChannelGetData</a> function to get data from its source channels. That means that the source channels must be decoding channels (not using a <a href="mk:@MSITStore:bass.chm::/RECORDPROC.html">RECORDPROC</a> in the case of a recording channel). Plugging a channel into more than one mixer at a time is not possible because the mixers would be taking data away from each other. An advantage of this is that there is no need for a mixer's handle to be provided with the channel functions. It is actually possible to plug a channel into multiple mixers by using <a href="BASS_Split_StreamCreate.html">splitter streams</a>.
<p>Channels can be removed with <a href="BASS_Mixer_ChannelRemove.html">BASS_Mixer_ChannelRemove</a>. They are also removed automatically when they are freed, or when they end in a queued mixer.
<p>When mixing a channel, the mixer makes use of the channel's freq/volume/pan attributes, as set with <a href="mk:@MSITStore:bass.chm::/BASS_ChannelSetAttribute.html">BASS_ChannelSetAttribute</a>. The <a href="mk:@MSITStore:bass.chm::/BASS_CONFIG_CURVE_VOL.html">BASS_CONFIG_CURVE_VOL</a> and <a href="mk:@MSITStore:bass.chm::/BASS_CONFIG_CURVE_PAN.html">BASS_CONFIG_CURVE_PAN</a> config option settings are also used. The channel's pan attribute has no effect when matrix mixing is enabled; panning can be applied in the matrix instead then.
<p>If a multi-channel source has more channels than the mixer output then the extra channels will be discarded by default. For example, if a 5.1 source is plugged into a stereo mixer then only the front-left/right channels will be retained. If the mixer is multi-channel too, but not the same as the source, then the source may also end up on the wrong speakers due to differing channel layouts. Matrix mixing can be used to fix both issues. The default matrix will remap channels to the correct speakers (unless the BASS_MIXER_NOSPEAKER flag is set on the mixer) but will not include unavailable channels. The BASS_MIXER_CHAN_DOWNMIX flag can be used to enable downmixing and have the unavailable channels mixed into the available ones. When multiple channels are combined by that, their levels are lowered to reduce the chances of clipping, but they are not normalized, so some clipping is still possible. If wanted, the matrix can be normalized afterwards, or indeed a different downmixing matrix used, via <a href="BASS_Mixer_ChannelSetMatrix.html">BASS_Mixer_ChannelSetMatrix</a>.
<p>The mixer processing is performed in floating-point, so it makes sense (for both quality and efficiency reasons) for the source channels to be floating-point too, though they do not have to be. It is also more efficient if the source channels have the same sample rate as the mixer output because no sample rate conversion is required then. When sample rate conversion is required, windowed sinc interpolation is used and the source's <a href="mk:@MSITStore:bass.chm::/BASS_ATTRIB_SRC.html">BASS_ATTRIB_SRC</a> attribute determines how many points/samples are used in that, as follows: 0 (or below) = 4 points, 1 = 8 points, 2 = 16 points, 3 = 32 points, 4 = 64 points, 5 = 128 points, 6 (or above) = 256 points. 8 points are used if the <a href="mk:@MSITStore:bass.chm::/BASS_ATTRIB_SRC.html">BASS_ATTRIB_SRC</a> attribute is unavailable (old BASS version). A higher number of points results in better sound quality (less aliasing and narrower transition band in the low-pass filter), but also higher CPU usage.
<p><h2>Platform-specific</h2>
The sample rate conversion processing is limited to 128 points on iOS and Android and Windows CE. The mixer processing is performed in fixed-point rather than floating-point on some platforms/architectures, as indicated by the <a href="mk:@MSITStore:bass.chm::/BASS_CONFIG_FLOAT.html">BASS_CONFIG_FLOAT</a> value.
<p><h2>See also</h2>
<a href="BASS_Mixer_ChannelFlags.html">BASS_Mixer_ChannelFlags</a>, <a href="BASS_Mixer_ChannelGetLevel.html">BASS_Mixer_ChannelGetLevel</a>, <a href="BASS_Mixer_ChannelGetMixer.html">BASS_Mixer_ChannelGetMixer</a>, <a href="BASS_Mixer_ChannelGetPosition.html">BASS_Mixer_ChannelGetPosition</a>, <a href="BASS_Mixer_ChannelIsActive.html">BASS_Mixer_ChannelIsActive</a>, <a href="BASS_Mixer_ChannelRemove.html">BASS_Mixer_ChannelRemove</a>, <a href="BASS_Mixer_ChannelSetMatrix.html">BASS_Mixer_ChannelSetMatrix</a>, <a href="BASS_Mixer_ChannelSetPosition.html">BASS_Mixer_ChannelSetPosition</a>, <a href="BASS_Mixer_StreamAddChannelEx.html">BASS_Mixer_StreamAddChannelEx</a>, <a href="BASS_Mixer_StreamCreate.html">BASS_Mixer_StreamCreate</a>
